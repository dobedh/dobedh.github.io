{"componentChunkName":"component---src-templates-post-tsx","path":"/TIL_39_210210/","result":{"data":{"markdownRemark":{"html":"<h1 id=\"60-introduction-to-passportjs\" style=\"position:relative;\"><a href=\"#60-introduction-to-passportjs\" aria-label=\"60 introduction to passportjs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[6.0] Introduction to PassportJS</h1>\n<h3 id=\"기능\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%EB%8A%A5\" aria-label=\"기능 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기능</h3>\n<ul>\n<li>유저의 authentication 정보를 확인하고 알려줌</li>\n<li>쿠키를 생성, 브라우저에 저장, 유저에게 할당</li>\n<li><code class=\"language-text\">passport-local-mongoose</code> 요건 user auth 의 기본적인 것들을 다 해주는 module.다음시간에 배워보자.</li>\n</ul>\n<h1 id=\"61-local-authentication-with-passport-part-one\" style=\"position:relative;\"><a href=\"#61-local-authentication-with-passport-part-one\" aria-label=\"61 local authentication with passport part one permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[6.1] Local Authentication with Passport part One</h1>\n<h3 id=\"1-passport-설치\" style=\"position:relative;\"><a href=\"#1-passport-%EC%84%A4%EC%B9%98\" aria-label=\"1 passport 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Passport 설치</h3>\n<ul>\n<li>PassportJS 공식 문서 : <a href=\"http://www.passportjs.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://www.passportjs.org/</a></li>\n<li><code class=\"language-text\">npm install passport</code></li>\n</ul>\n<h3 id=\"2-user-model-생성-userjs\" style=\"position:relative;\"><a href=\"#2-user-model-%EC%83%9D%EC%84%B1-userjs\" aria-label=\"2 user model 생성 userjs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. User Model 생성 (User.js)</h3>\n<ul>\n<li>아래 코드에서 로직을 잘 이해해보자.</li>\n<li>\n<ol>\n<li>우선, DB생성을 위하여 mongoose를 import</li>\n</ol>\n</li>\n<li>\n<ol start=\"2\">\n<li>\"이 DB의 구조는 이래!\"를 알려주기 위해, schema 생성</li>\n</ol>\n</li>\n<li>\n<ol start=\"3\">\n<li>생성된 스키마로, model을 생성!</li>\n</ol>\n</li>\n<li>\n<ol start=\"4\">\n<li>이 모델을 이제 내보내주자!</li>\n</ol>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    import mongoose from &quot;mongoose&quot;;\n\n    const UserSchema = new mongoose.Schema({\n    name: String,\n    email: String,\n    avatarUrl: String, // 이게 뭘까?\n    facebookId: Number,\n    githubId: Number,\n    });\n\n    const model = mongoose.model(&quot;User&quot;, UserSchema);\n\n    export default model;</code></pre></div>\n<h3 id=\"3-user-model-을-init에-import\" style=\"position:relative;\"><a href=\"#3-user-model-%EC%9D%84-init%EC%97%90-import\" aria-label=\"3 user model 을 init에 import permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. User model 을 init에 import</h3>\n<h3 id=\"4-passport-local-mongoose-설치\" style=\"position:relative;\"><a href=\"#4-passport-local-mongoose-%EC%84%A4%EC%B9%98\" aria-label=\"4 passport local mongoose 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. passport-local-mongoose 설치</h3>\n<ul>\n<li>password 확인, 설정 등을 자동으로 해주는 모듈</li>\n<li>`npm install passport-local-mongoose</li>\n<li>설치후, User모델에서 passport-local-mongoose를 import하고, usernameField를 설정</li>\n</ul>\n<h3 id=\"41-passport-local-plugin-추가\" style=\"position:relative;\"><a href=\"#41-passport-local-plugin-%EC%B6%94%EA%B0%80\" aria-label=\"41 passport local plugin 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4.1 passport-local plugin 추가</h3>\n<ul>\n<li>기존의 User model에, 비밀번호를 자동으로 체크, 설정할 수 있는 passport-local 플러그인을 추가해보자!</li>\n<li>해당 코드로, passport-local에 있는 많은것을 쓸 수 있음</li>\n<li>but 이걸로 실제 auth를 하는건 아님. 그래서 다음의 auth를 하는 passport.js 생성</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">import passportLocalMongoose from &quot;passport-local-mongoose&quot;;\nUserSchema.plugin(passportLocalMongoose, { usernameField: &quot;email&quot; });</code></pre></div>\n<h3 id=\"5-passportjs-생성-passport-local-설치\" style=\"position:relative;\"><a href=\"#5-passportjs-%EC%83%9D%EC%84%B1-passport-local-%EC%84%A4%EC%B9%98\" aria-label=\"5 passportjs 생성 passport local 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. passport.js 생성, passport-local 설치</h3>\n<ul>\n<li>실제 user auth를 하는건 <code class=\"language-text\">passport.js</code>에서 이루어진다</li>\n<li>\n<p>passport.js 파일에서, strategy를 설정해준다</p>\n<ul>\n<li>strategy란, 우리가 어떤 로그인 방식을 사용할지에 관한 것</li>\n<li>페이스북, 깃헙, 카카오 로그인 등</li>\n</ul>\n</li>\n<li>코드 : passport와 user를 import해주고, strategy 설정</li>\n<li>아래의 <code class=\"language-text\">createStrategy</code>는 매우 많은 코드(유저명 확인, 패스워드 확인) 등을 한줄로 짧게 해준것</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">import passport from &quot;passport&quot;;\nimport User from &quot;./models/User&quot;;\n\npassport.use(User.createStrategy());</code></pre></div>","excerpt":"6.0 Introduction to PassportJS 기능 유저의 authentication 정보를 확인하고 알려줌 쿠키를 생성, 브라우저에 저장, 유저에게 할당  요건 user auth 의 기본적인 것들을 다 해주는 module.다음시간에 배워보…","tableOfContents":"<ul>\n<li>\n<p><a href=\"/TIL_39_210210/#60-introduction-to-passportjs\">6.0 Introduction to PassportJS</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/TIL_39_210210/#%EA%B8%B0%EB%8A%A5\">기능</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/TIL_39_210210/#61-local-authentication-with-passport-part-one\">6.1 Local Authentication with Passport part One</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/TIL_39_210210/#1-passport-%EC%84%A4%EC%B9%98\">1. Passport 설치</a></li>\n<li><a href=\"/TIL_39_210210/#2-user-model-%EC%83%9D%EC%84%B1-userjs\">2. User Model 생성 (User.js)</a></li>\n<li><a href=\"/TIL_39_210210/#3-user-model-%EC%9D%84-init%EC%97%90-import\">3. User model 을 init에 import</a></li>\n<li><a href=\"/TIL_39_210210/#4-passport-local-mongoose-%EC%84%A4%EC%B9%98\">4. passport-local-mongoose 설치</a></li>\n<li><a href=\"/TIL_39_210210/#41-passport-local-plugin-%EC%B6%94%EA%B0%80\">4.1 passport-local plugin 추가</a></li>\n<li><a href=\"/TIL_39_210210/#5-passportjs-%EC%83%9D%EC%84%B1-passport-local-%EC%84%A4%EC%B9%98\">5. passport.js 생성, passport-local 설치</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/TIL_39_210210/"},"frontmatter":{"title":"TIL-210210","date":"Feb 10, 2021","tags":["JS","passport"],"keywords":["dobedh","Donghyun Kim"],"update":"Jan 01, 0001"}}},"pageContext":{"slug":"/TIL_39_210210/","series":[],"lastmod":"2021-02-10"}},"staticQueryHashes":["2027115977","694178885"]}